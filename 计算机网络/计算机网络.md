# 计算机网络

[TOC]

## 1. 简述

## 2. 物理层

## 3. 数据链路层

## 4. 网络层

## 5. 运输层

### 5.1 概述

​	计算机网络体系结构中的**物理层、数据链路层以及网络层**它们共同解决了将主机通过异构网络互联起来所面临的问题，**实现了主机到主机的通信**。

​	但实际上在计算机中进行**通信的真正实体是位于通信两端主机中的进程**。

​	**如何为运行在不同主机上的应用进程（AP）提供直接的通信服务是运输层的任务**，运输层协议又称为端到端协议

![image-20240330213528226](Images\image-20240330213528226.png)

​	假设AP1和AP4之间，AP2和AP3之间进行基于网络的通信，在运输层使用**不同的端口**对于不同的应用进程，通过网络层及其下层来传输应用层报文，接收方的运输层**通过不同的端口将收到的应用层报文交付给应用层中相应的应用进程**。需要注意的是，这里的**端口是指用来区分不同应用进程的标识符**，可以简单的认为**运输层直接为应用进程间的逻辑通信提供服务**

**逻辑通信：**运输层之间的通信好像是沿水平方向传送数据，但事实上两条运输层之间并没有一条水平方向的物理连接，**运输层向高层用户屏蔽了网络核心的细节**（如网络拓扑，所采用的路由选择协议等）。

​	根据应用需求的不同，**因特网的运输层**为应用层提供了两种不同的运输协议，即**面向连接的TCP**和**无连接的UDP**，这两种协议就是本章讨论的主要内容。

![image-20240330220146188](Images\image-20240330220146188.png)

### 5.2 端口号，复用与分用

#### 5.2.1 端口号

**定义：**

​	与本地进程通信（IPC）使用进程标识符PID来标识不同进程不同，远程进程通信（RPC）使用**端口号来标识不同的进程。** 这是因为因特网上的计算机使用的并不是统一的操作系统，**不同的操作系统有不同格式的PID**，为了使这些使用不同操作系统的计算机的应用进程能进行通信就**必须定义一个统一的格式对TCP/IP体系的应用程序进行标识**，这就是端口号存在的意义



**端口号使用16比特表示，取值范围0~65535：**

- **熟知端口号：** **0~1023**，互联网数字分配机构（IANA）把这些端口号指派给了TCP/IP体系中最重要的一些应用协议，例如:FTP使用21/20，HTTP使用80，DNS使用53；
- **登记端口号：**1024~49151，为没有熟知端口号的应用程序使用。使用这类端口号必须在IANA按照规定
  的手续登记，以防止重复。例如:Microsoft RDP 微软远程桌面使用的端口是3389；
- **短暂端口号：**49152~65535，留给客户进程选择暂时使用。当服务器进程收到客户进程的报文时，就知道了客户进程所使用的**动态端口号**。通信结束后，这个端口号可供其他客户进程以后使用；

​	**端口号只具有本地意义**，即端口号只是为了**标识本计算机应用层中的各进程**，在因特网中**不同计算机中的相同端口号是没有联系的**



#### 5.2.2 发送方的复用和接收方的分用

***复用：与发送方有关***

- **UDP复用：** **发送方**发送的应用报文在运输层使用UDP协议进行封装，这称为UDP复用；
- **TCP复用：** **发送方**发送的应用报文在运输层使用TCP协议进行封装，这称为TCP复用；
- **IP复用：**运输层使用端口号来区分不同的应用进程，不管**发送方**使用运输层的UDP协议封装成的**UDP用户数据报**，还是使用TCP协议封装成的**TCP报文段**，在**网络层**都需要**使用IP协议封装成IP数据报**，这称为IP复用。根据**协议字段的不同来区分**封装的是UDP数据报（17）还是TCP报文段（6）；



***分用：与接收方有关***

**IP分用：** **接收方**的**网络层**收到IP数据报后进行IP分用，若IP数据报协议字段值为17则把IP数据报的数据载荷部分封装的UDP用户数据报**上交给运输层的UDP**，若值为6则把IP数据报的数据载荷部分封装的TCP报文段上交给**运输层的TCP；**

**UDP分用：** **接收方**对UDP用户数据报进行UDP分用，根据端口号交付给对应的应用进程；

**TCP分用：** **接收方**对TCP报文报进行TCP分用，根据端口号交付给对应的应用进程；

![image-20240330222951053](Images\image-20240330222951053.png)

****

***TCP/IP体系应用层常用协议所使用的运输层熟知端口号***

![image-20240330223139728](Images\image-20240330223139728.png)



### 5.3 UDP和TCP的对比

**UDP**和**TCP**是TCP/IP体系结构**运输层**中的**两个重要协议**，在使用TCP/IP体系结构的网络通信中，UDP和TCP的使用协议仅次于网络层的IP协议

## 6. 应用层

